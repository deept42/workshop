<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Workshop WMRD-PR</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
    <style>
        body { font-family: 'Inter', sans-serif; background-color: #f3f4f6; }
        /* Custom scrollbar para um look mais moderno */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }
        
        /* --- Estilos Profissionais para a Tabela --- */
        .admin-table th {
            background-color: #f8fafc; /* Um cinza muito claro para o cabeçalho */
            color: #475569; /* Cor do texto do cabeçalho (cinza escuro) */
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding: 1rem 1.5rem; /* Mais espaçamento */
            cursor: pointer; /* Indica que o cabeçalho é clicável (para ordenação futura) */
            transition: background-color 0.2s;
        }
        .admin-table th:hover { background-color: #f1f5f9; }
        .admin-table tbody tr:nth-child(even) { background-color: #f8fafc; } /* Linhas zebradas */
        .admin-table tbody tr:hover { background-color: #eff6ff; } /* Destaque azul claro no hover */
        .admin-table td {
            padding: 1rem 1.5rem; /* Mais espaçamento */
            color: #334155; /* Cor do texto do corpo (cinza mais escuro) */
            border-top: 1px solid #e2e8f0;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <header class="flex flex-col sm:flex-row justify-between items-center mb-8 pb-4 border-b border-gray-300">
        <div>
            <h1 class="text-3xl font-bold text-[#062E51]">Dashboard</h1>
            <p class="text-gray-600">Lista de inscritos no Workshop.</p>
        </div>
        <div class="flex items-center gap-4 mt-4 sm:mt-0">
            <div class="text-right">
                <p class="text-sm text-gray-500">Logado como:</p>
                <p id="admin-email" class="font-semibold text-[#062E51]">carregando...</p>
            </div>
            <button id="admin-logout-btn" class="bg-[#E63946] hover:bg-[#c9323d] text-white font-bold py-2 px-4 rounded-lg flex items-center gap-2 transition-colors">
                <span class="material-symbols-outlined">logout</span>
                Sair
            </button>
        </div>
    </header>

    <main class="space-y-8">
        <!-- Seção de Métricas Chave -->
        <section>
            <h2 class="text-xl font-bold text-gray-700 mb-4">Resumo do Evento</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                <!-- Card Total de Inscritos -->
                <div class="bg-white p-6 rounded-lg shadow-md flex items-center gap-4">
                    <div class="bg-blue-100 p-3 rounded-full"><span class="material-symbols-outlined text-3xl text-blue-600">groups</span></div>
                    <div>
                        <p class="text-sm font-medium text-gray-500">Total de Inscritos</p>
                        <p id="total-inscritos" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
                <!-- Card Municípios -->
                <div class="bg-white p-6 rounded-lg shadow-md flex items-center gap-4">
                    <div class="bg-green-100 p-3 rounded-full"><span class="material-symbols-outlined text-3xl text-green-600">location_city</span></div>
                    <div>
                        <p class="text-sm font-medium text-gray-500">Municípios Diferentes</p>
                        <p id="total-municipios" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
                <!-- Card Adesão ao Certificado -->
                <div class="bg-white p-6 rounded-lg shadow-md flex items-center gap-4">
                    <div class="bg-yellow-100 p-3 rounded-full"><span class="material-symbols-outlined text-3xl text-yellow-600">workspace_premium</span></div>
                    <div>
                        <p class="text-sm font-medium text-gray-500">Adesão ao Certificado</p>
                        <p id="taxa-certificado" class="text-3xl font-bold text-gray-800">0%</p>
                    </div>
                </div>
                <!-- Card Interativo de Participantes por Dia -->
                <div id="card-participantes-dia" class="bg-white p-6 rounded-lg shadow-md flex items-center gap-4 cursor-pointer hover:shadow-lg hover:-translate-y-1 transition-all duration-300">
                    <div id="card-participantes-icon-bg" class="p-3 rounded-full transition-colors"><span id="card-participantes-icon" class="material-symbols-outlined text-3xl transition-colors">today</span></div>
                    <div>
                        <p id="card-participantes-titulo" class="text-sm font-medium text-gray-500 flex items-center">Participantes Dia 13 <span class="material-symbols-outlined text-base ml-1 text-gray-400">sync_alt</span></p>
                        <p id="card-participantes-valor" class="text-3xl font-bold text-gray-800">0</p>
                    </div>
                </div>
            </div>
        </section>

        <!-- Seção de Gráficos -->
        <section class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Gráfico de Participação por Dia -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-bold text-[#062E51] mb-4">Participação por Dia</h2>
                <div class="h-64 flex items-center justify-center">
                    <canvas id="grafico-dias"></canvas>
                </div>
            </div>
            <!-- Gráfico de Top 5 Municípios -->
            <div class="bg-white p-6 rounded-lg shadow-md">
                <h2 class="text-xl font-bold text-[#062E51] mb-4">Top 5 Municípios por Inscrição</h2>
                <div class="h-64 flex items-center justify-center">
                    <canvas id="grafico-municipios"></canvas>
                </div>
            </div>
        </section>

        <!-- Seção da Tabela de Inscritos -->
        <div class="bg-white p-6 rounded-lg shadow-md">
            <div class="flex flex-col sm:flex-row gap-4 mb-4">
                <!-- Novo Componente de Busca com Dropdown -->
                <div class="flex w-full group">
                    <select id="filtro-coluna" class="flex-shrink-0 p-3 border border-r-0 border-gray-300 rounded-l-lg bg-gray-50 focus:ring-2 focus:ring-[#062E51] focus:outline-none transition text-gray-600 font-semibold">
                        <option value="all">Buscar em Tudo</option>
                        <option value="nome">Nome</option>
                        <option value="email">E-mail</option>
                        <option value="municipio">Município</option>
                        <option value="empresa">Empresa</option>
                        <option value="dias">Dia</option>
                    </select>
                    <input type="text" id="filtro-busca" placeholder="Digite para filtrar..." class="w-full p-3 border border-gray-300 rounded-r-lg focus:ring-2 focus:ring-[#062E51] focus:outline-none transition group-focus-within:border-[#062E51] group-focus-within:ring-2">
                </div>
                <button id="export-csv-btn" class="flex-shrink-0 bg-gray-100 hover:bg-gray-200 text-gray-700 font-bold py-2 px-4 rounded-lg flex items-center justify-center gap-2 transition-colors border border-gray-300">
                    <span class="material-symbols-outlined">download</span>
                    Exportar CSV
                </button>
                <button id="export-pdf-btn" class="flex-shrink-0 bg-[#062E51] hover:bg-[#001B3E] text-white font-bold py-2 px-4 rounded-lg flex items-center justify-center gap-2 transition-colors">
                    <span class="material-symbols-outlined">picture_as_pdf</span>
                    Exportar PDF
                </button>
            </div>
            <div class="overflow-x-auto">
                <table class="admin-table min-w-full">
                    <thead>
                        <tr>
                            <th scope="col" data-column="nome_completo">
                                <div class="flex items-center gap-2">Nome Completo <span class="material-symbols-outlined text-sm opacity-50">unfold_more</span></div>
                            </th>
                            <th scope="col" data-column="email">
                                <div class="flex items-center gap-2">E-mail <span class="material-symbols-outlined text-sm opacity-50">unfold_more</span></div>
                            </th>
                            <th scope="col" data-column="telefone">
                                <div class="flex items-center gap-2">Telefone <span class="material-symbols-outlined text-sm opacity-50">unfold_more</span></div>
                            </th>
                            <th scope="col" data-column="empresa">
                                <div class="flex items-center gap-2">Empresa <span class="material-symbols-outlined text-sm opacity-50">unfold_more</span></div>
                            </th>
                            <th scope="col" data-column="municipio">
                                <div class="flex items-center gap-2">Município <span class="material-symbols-outlined text-sm opacity-50">unfold_more</span></div>
                            </th>
                            <th scope="col" data-column="dias">
                                <div class="flex items-center gap-2">Dias <span class="material-symbols-outlined text-sm opacity-50">unfold_more</span></div>
                            </th>
                        </tr>
                    </thead>
                    <tbody id="lista-inscritos">
                        <!-- Linha de carregamento -->
                        <tr>
                            <td colspan="6" class="px-6 py-4 text-center text-gray-500">Carregando inscritos...</td>
                        </tr>
                        <!-- As linhas com os dados dos inscritos serão inseridas aqui via JavaScript -->
                    </tbody>
                </table>
            </div>
        </div>
    </main>

    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
    <script src="js/admin.js" type="module"></script>

</body>
</html>